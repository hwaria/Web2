생활코딩 – Home Server: 자신의 집에서 서버를 운영하는 방법 – 공유기를 사용하는 환경에서 웹서버를 운영하기 위해 필요한 지식, 네트워크와 관련된 핵심 개념

1.	수업 소개
-	공유기를 사용하는 환경에서 불특정 다수가 접근할 수 있는 웹서버 구동하기
-	컴퓨터와 컴퓨터가 서로 통신을 하기 위해서는 ip address가 필요함 
-	80년대 초 지정된 Ipv4 통신 규칙: 42억개의 주소를 표현할 수 있음
-	웹, 스마트폰 ,클라우드 컴퓨팅, 사물인터넷 등 정보 혁신이 일어나면서 인터넷에 연결되는 컴퓨터의 수가 기하급수적으로 증가됨 -> 42억개의 주소가 동이 나게 됨
-	해결책: 주소의 형식을 바꾸기 –> 새로운 인터넷 통신 규칙 ipv6 등장: 충분히 쓸 수 있는 ip 주소가 생겼으나, 이미 존재하고 있는 ip주소를 바꾸는 것이 어렵기 때문에 당분간은 기존의 ipv4를 써야함 -> 노력의 일환으로 공유기 사용: 하나의 ip주소를 다수의 컴퓨터가 쓸 수 있음
-	공유기에 연결되어 잇는 컴퓨터에 서버를 설치하는 것은 어려움 – network address translation, public vs private ip address, Port forwarding, dynamic vs static ip address, dynamic DNS와 같은 개념을 알아야 함
-	클라이언트로만 사용되던 우리의 컴퓨터를 서버로 사용하게 하기!

2.	공유기(router)가 하는 일 & 사설 ip와 공용 ip의 차이점
-	Ip address: 인터넷을 사용하기 위해서(다른 컴퓨터와 통신하기 위해서) 컴퓨터가 가지는 것, 양측의 ip 주소를 이용하여 정보를 요청하고 응답하며 정보 교환
-	인터넷을 사용하려면 – 통신사와 계약 – 공유기를 구매: wan(통신사에서 받은 케이블), lan에 각각의 장치를 연결: 통신사로 발급받은 ip(public ip address)는 공유기에 속하게 됨(컴퓨터가 아닌) – 지역 네트워크(공유기에 연결된 장치들)가 형성되고 인터넷 광역 네트워크(wan: wide area network)에 연결됨 – 공유기는 중개자 역할을 함 – lan에 연결된 각각의 장치는 ip가 부여됨 (= gateway address/router address)
-	공유기가 가지고 있는 IP는 공용 IP / 연결된 각각의 장치가 가지고 있는 IP는 내선번호 같은 것, 사설 IP, 지역 네트워크에서만 사용 가능
-	Ipv4 주소 체계에서 192.168.0.0 ~ 192.168.255.255 속할 경우 사설 IP, 수용할 수 있는 장치의 수가 제한

3.	NAT(Network address translation): 공유기에 연결된 장치들이 인터넷을 통해 공유기 밖에 정보에 접속할 수 있게 함
-	 
-	사설 IP ‘192.168.0.4’를 가지고 있는 내 컴퓨터로 위키피디아에 접속을 하려면?
: 내 컴퓨터는 게이트웨이 어드레스에 해당되는 기계(공유기)에 신호를 보냄 – 위키피디아 접속 요청은 내부 네트워크 외의 요청이기때문에 외부로 보내야함 – 이를 위해서 공유기는, 1) 이 요청이 192.168.0.4의 ip를 가진 컴퓨터에서 왔음을 공유기 내에 기록 2) nat 기술을 이용하여 192.168.04 ip를 -> 59.6.66.238 (공용 ip)로 변경하여 외부로 요청을 보냄 -> 위키피디아는 응답을 59.6.66.238로 보냄 -> 공유기는 그 응답을 192.168.04 ip를 가지는 컴퓨터로 보냄 *컴퓨터를 클라이언트로 사용하는 경우
-	그럼 컴퓨터를 홈서버로 사용하기위해 어떻게 요청을 처리해야 외부에 있는 사용자가 내 컴퓨터 서버에 접속할 수 있을까?

4.	내 컴퓨터의 IP 주소 알아내기
-	윈도우: 제어판 – 네트워크 & 인터넷 – 접속 – details – ipv4 address: 10.1.1.4 이 컴퓨터의 내부 네트워크 상의 ip 주소, ipv4 default gateway: 10.1.1.1 공유기의 ip 주소
-	맥: 환경설정 – 네트워크 – 현재 연결된 네트워크 – 고급 – tcp/ip에서 ipv4 address: 컴퓨터 ip 주소, router address: 공유기의 ip 주소 
-	공유기 ip 주소를 주소창에 입력하여 공유기로 접속 – 로그인 – 관리 도구창 – 공유기 동작 설정 가능
-	공용 ip 주소 확인하려면? 관리 도구창 - 외부 ip 주소 59.6.66.238
-	검색 엔진에서 “my ip” 검색해서 링크 들어가보면 공용 ip 알려줌

5.	포트 (port): 하나의 컴퓨터에는 여러 개의 서버가 설치될 수 있음, 클라이언트가 컴퓨터에 접속할 때 어떤 서버와 접속하려고 하는지 구분을 위해 PORT 개념 사용 -> 포트는 컴퓨터 안에 설치된 서버에 접속하는 주소
-	컴퓨터를 클라이언트가 아니라 서버로 사용하고 싶은 경우 공용 ip가 아닌 컴퓨터의 서버에 접속할 수 있도록 해야함
-	Port: 서버를 식별하기 위한 고유 번호, 총 육만오천개의 포트 중 80번을 웹이 쓰도록 정해져있음 – 두 번째 웹서버를 설치할 경우 8080번 포트를 보통 사용 – url http://opentutorials.org라는 주소를 입력했을 때 컴퓨터는 80번 포트로 연결시켜줌, 만약 8080에 리스닝하고 있는 웹서버에 접속하고 싶으면http://opentutorials.org:8080 으로 접속 
-	url format: 통신규약(http)://호스트(도메인):포트번호 
-	Port forwarding: 공유기 내부 네트워크의 컴퓨터를 퍼블릭한 서버로 이용하게 함

6.	포트 포워딩 (port forwarding): 공유기 외부에서 공유기 내부의 컴퓨터에 접속하기 위해서는 공유기의 몇 번 포트에 접속한 정보를 공유기 내의 어떤 아이피의 몇 번 포트로 연결해 줄 것인지를 공유기에 알려줘야 함 
-	접속하는 사용자들이 공유기의 공용 ip 특정 포트로 접속했을 때 요청 정보가 있는 컴퓨터 사설 ip의 특정 포트로 연결되도록 함
-	59.6.66.238:8080 -> 192.168.0.3:80
-	59.6.66.238:8081 -> 192.168.0.4:80
-	공유기 관리도구 – NAT/라우터관리 - 포트포워드 설정 – 규칙이름 web server 1 – 내부 ip 주소 192.168.0.4, 외부 포트 8081 ~ / 내부포트 80 ~ - 적용시 규칙이 등록됨 -> 외부포트(공용 IP) 8081로 접속시 내부ip ~0.4의 80번 포트로 연결됨

7.	유동 아이피와 고정 아이피 (Dynamic & Static IP address): 가정에서 서버를 운영하는 것이 어려운 이유 중 하나는 통신사로부터 제공받은 IP 주소가 바뀌기 때문. 왜 IP 주소가 변경될까? 어떻게 고정시킬까?
-	Dynamic IP address: 부족한 IP를 좀 더 효율적으로 사용하기 위한 방안 중 하나 
-	인터넷을 쓰기 위해서는 통신사(ISP: Internet Service Provider)와 계약을 맺고 공용 IP 주소를 부여받음 – 웹서버를 설치 후 IP 주소를 사용자에 알려줌
-	유동 IP: 통신사들은 인터넷을 안쓰는 사용자의 IP를 회수해서 다른 사용자에게 IP를 임대해줌 -> 사용자입장에서는 IP주소가 바뀔 경우 기존의 웹서버접속을 위해 알려주던 공용 IP주소가 무용지물이 됨
-	고정 IP: 컴퓨터의 IP주소를 독점적으로 사용함. 비용이 듬

8.	DHCP (Dynamic Host Configuration Protocol): 네트워크에 접속한 장치의 IP, subnet mask, gateway address, DNS와 같은 정보를 자동으로 설정해주는 기술 
-	새로운 장치를 사서 인터넷에 연결하기위해 IP를 수동으로 지정하기: 윈도우의 경우 – 제어판 – 네트워크&인터넷 – 네트워크 공유센터 – 연결 – 프로퍼티 – tcp/ipv4 – 속성 – 직접 IP를 입력할 수 있음 
	직접 IP 설정시 입력해야 할 정보들이 많음 (ip, subnet mask, gateway address, dns): 대신 설정해주는 DHCP 기술 이용
-	공유기를 사면 DHCP 서버 프로그램이 내장되어있음 – 또, 인터넷을 사용하는 기계들은 DHCP 클라이언트 프로그램이 기본적으로 설치되어있음 – 통신 부품들은 각각 공장에서 기록된 고유한 식별자를 가짐(Mac address) – 장치 구매 후 인터넷에 처음 연결하면 이 기기는 DHCP 서버에 IP 주소 요청을 보냄 – 기기가DHCP 서버로부터 받은 내부 IP를 쓰겟다고 알려주면 공유기는 IP를 기록 
-	공유기 접속 – 네트워크 관리- 내부 네트워크 설정: DHCP 서버를 제어하는 기능 – 동적 IP 주소 범위, IP 대여시간 등 확인 가능 (보통 2시간인듯?), 사용중인 IP 주소 정보에서 현재 연결되어있는 장치의 내부 IP주소와 장치의 고유 식별자 확인 가능
-	“장치들은 보통 유동 IP를 가지고 그 IP는 DHCP 서버로부터 지정되었다”

9.	수업을 마치며
-	인터넷에 대한 이해
-	NAS: network attached storage, 네트워크를 사용하는 저장장치 (드롭박스, 구글드라이브같은 것을 내 컴퓨터에서 직접 운용), 데이터 저장, 백업 등을 함
-	IP address가 아닌 도메인을 이용해서 서버에 접속하게 할 수 있음:도메인은 고정, IP를 유동적으로 사용할수 있음
-	Dynamic DNS: 고정 IP를 가지고있는 것과 같은 비슷한 효과
-	보안성이 강화된 https: 안전하게 정보를 서버와 클라이언트가 주고받을수 있도록 함. 빠른 속도로 무료로 이용할 수 있음
-	Let’s encrypt: 무료로 인증서를 발급해줌
-	가정에서 서버를 운용하면 효율적이지는 않음 -> 웹호스팅 업체, 클라우드 컴퓨팅 등의 서비스를 이용 가능, 위 원리들이 거의 그대로 적용됨
